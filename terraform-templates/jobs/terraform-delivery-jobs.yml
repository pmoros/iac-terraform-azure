parameters:
  environment: "stage"
  azureServiceConnection: "ARM_SUBSCRIPTION"
  terraformFormat: false
  terraformValidate: true
  terraformPlan: true
  terraformApply: false

jobs:
  - job: Terraform delivery
    displayName: "Terraform delivery"
    pool:
      vmImage: "ubuntu-latest"
    variables:
      - template: ../variables/terraform-variables.yml
        parameters:
          environment: $(environment)
    steps:
      - template: ../steps/terraform-delivery-steps.yml
        parameters:
          environment: ${{ parameters.environment }}
          azureServiceConnection: ${{ parameters.azureServiceConnection }}
          terraformFormat: ${{ parameters.terraformFormat }}
          terraformValidate: ${{ parameters.terraformValidate }}
          terraformPlan: ${{ parameters.terraformPlan }}
          terraformApply: ${{ parameters.terraformApply }}
